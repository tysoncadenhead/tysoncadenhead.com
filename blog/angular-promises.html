<!DOCTYPE html>
<!--[if IE 6]>
    <html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
    <html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
    <html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
    <html lang="en-US">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
        <meta name="google-site-verification" content="AeV4w7EOhEv3lU1OT8KOM7jRS0C6jDAsZyMaG38t1g4" />
        <meta property="og:image" content="http://www.tysoncadenhead.com/images/blog/angular-promises.png"/>
        <meta property="og:title" content="A Crash Course On Angular Promises"/>
        <meta property="og:url" content="http://www.tysoncadenhead.com"/>
        <meta property="og:site_name" content="Tyson Cadenhead"/>
        <meta property="og:description" content="The Art Of Elegant JavaScript Applications" />
        <title>A Crash Course On Angular Promises</title>
        <link rel="shortcut icon" href="/images/favicon.ico" /> 
        <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/css/app.css" />
        <link rel="alternate" type="application/rss+xml" title="A Crash Course On Angular Promises The Art Of Elegant JavaScript Applications" href="http://www.tysoncadenhead.com/feed.xml" />
        
    </head>
    <body>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-19696495-1']);
          _gaq.push(['_trackPageview']);
        
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        
        </script>
        <div id="fb-root"></div>
        <div class="container">
            <div class="header" id="top">
                <div class="span12">
                    <div class="span4 left">
                        <h1 id="logo"><a href="/"><img src="/images/logo-new.png" /></a></h1>
                    </div>
                    <div id="nav-toggle">
                        <span></span>
                    </div>
                    <div class="span6 right">
                        <div class="navbar navbar-inverse">
                            <div class="navbar-inner right">
                                <ul class="nav right">
                                  <li><a href="/">Blog</a></li>
                                  <li><a href="/presentations">Presentations</a></li>
                                  <li><a href="/videos">JavaScript Vignettes</a></li>
                                  <li><a href="/about">About Me</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="span12">
                
                    
                    
                        
                        

<script type="text/javascript">
var posts = {"avoid-using-lodash-defer":{"published":true,"title":"Avoid Using _.defer()","tags":["javascript"],"category":"code","date":"1/18/2016","thumbnail":"/images/blog/avoid-using-lodash-defer.jpg"},"use-object-dot-keys-to-loop-over-objects":{"published":true,"title":"Use Object.keys() To Loop Over Objects","tags":["javascript"],"category":"code","date":"1/4/2016","thumbnail":"/images/blog/use-object-dot-keys-to-loop-over-objects.jpg"},"what-will-2016-hold-for-tyson-cadenhead":{"published":true,"title":"What Will 2016 hold for tysoncadenhead.com?","tags":["javascript"],"category":"code","date":"1/1/2016","thumbnail":"/images/blog/what-will-2016-hold-for-tyson-cadenhead.jpg"},"private-methods-in-javascript":{"published":true,"title":"Private Methods In JavaScript","tags":["javascript","es6"],"category":"code","date":"12/21/2015","thumbnail":"/images/blog/private-methods-in-javascript.jpg"},"unit-testing-react-components-with-mocha":{"published":true,"title":"Unit Testing React Components With Mocha","tags":["react","javascript","testing","mocha"],"category":"code","date":"12/13/2015","thumbnail":"/images/blog/unit-testing-react-components-with-mocha.jpg"},"handling-clicks-outside-an-element":{"published":true,"title":"Handling Clicks Outside An Element","tags":["javascript"],"category":"code","date":"11/28/2015","thumbnail":"/images/blog/handling-clicks-outside-an-element.png"},"pro-tip-use-consistent-spacing-between-variable-names-to-avoid-merge-conflicts":{"published":true,"title":"Pro-Tip: Use Consistent Spacing Between Variable Names to Avoid Merge Conflicts","tags":["javascript"],"category":"code","date":"11/13/2015","thumbnail":"/images/blog/merge.png"},"where-should-i-put-javascript-unit-tests":{"published":true,"title":"Where Should I Put JavaScript Unit Tests?","tags":["javascript","architecture","testing","mocha"],"category":"code","date":"11/7/2015","thumbnail":"/images/blog/where-should-i-put-javascript-unit-tests.jpg"},"how-to-organize-component-based-code":{"published":true,"title":"How To Organize a Component-Based Application","tags":["javascript","architecture","react"],"category":"code","date":"11/1/2015","thumbnail":"/images/blog/how-to-organize-component-based-code.jpg"},"what-is-es6-destructuring":{"published":true,"title":"What Is ES6 Destructuring?","tags":["javascript","es6"],"category":"code","date":"10/25/2015","thumbnail":"/images/blog/what-is-es6-destructuring.jpg"},"what-are-arrow-functions":{"published":true,"title":"What Are Arrow Functions?","tags":["javascript","es6"],"category":"code","date":"10/20/2015","thumbnail":"/images/blog/what-are-arrow-functions.jpg"},"react-with-es6-classes":{"published":true,"title":"React With ES6 Classes","tags":["react","es6"],"category":"code","date":"08/03/2015","thumbnail":"/images/blog/react-es6-classes.png"},"what-will-javascript-be-like-in-2015":{"published":true,"title":"What Will JavaScript Be Like In 2015?","tags":["javascript"],"category":"code","date":"01/03/2015","thumbnail":"/images/blog/what-will-javascript-be-like-in-2015.png"},"angular-promises":{"published":true,"title":"A Crash Course On Angular Promises","tags":["angular","promises"],"category":"code","date":"12/22/2014","thumbnail":"/images/blog/angular-promises.png","yield":"<p>Writing complex behaviors in an asynchronous language like JavaScript can be a bit of a challenge. If you aren&#39;t careful, you can make some pretty ugly nested code in order to get things to work like you expect. To solve the problem of illegible nested callbacks, we have promises. If you are writing applications in Angular, you are in luck because Angular ships with a great promise library called &quot;Q&quot;. Today, we&#39;re going to look at a few approaches to making more readable and maintainable Angular applications with the help of the built in Q promise library.</p>\n<!-- more -->\n<p><img src=\"http://cdn.meme.am/instances/500x/54391964.jpg\" width=\"50%\" alt=\"\"></p>\n<h3>What Are Promises?</h3><p>In the distant past, I have been guilty of writing things like this:</p>\n<pre><code>myModels.getPerson({ id: 1 }, function (person) {\n   myModels.getDad(person, function (dad) {\n        myModels.getPet(dad, function (pet) {\n            myModels.getPetColor(pet, function (color) {\n                // ...\n            });\n        });\n   });\n});\n</code></pre><p>It looks really ugly, but there were instances where I needed to make one asynchronous operation, then based on the data that I got back from the operation, I would need to make another operation and the tunnel of madness would begin. Promises are an answer to that problem.</p>\n<p>Whether you know it or not, you&#39;ve probably been exposed to promises inside of libraries like jQuery when you tack a <code>then()</code> method on after a function.</p>\n<p>The way it works is that the function returns a &quot;promise&quot; instead of a result. Inside the function, the promise can be resolved at some point and the <code>then()</code> method is fired which continues the chain of methods you are building.</p>\n<p>Taking our contrived example above, if we were using promises, it might look more like this:</p>\n<pre><code>myModels\n    .getPerson({\n        id: 1\n    })\n    .then(myModels.getDad)\n    .then(myModels.getPet)\n    .then(myModels.getPetColor)\n    .done(function (data) {\n        // ...\n    });\n</code></pre><p>Now we&#39;ve got an API that is readable and maintainable. Life is good again.</p>\n<p><img src=\"http://www.quickmeme.com/img/01/015f8f78101fcf7e97a3b9492a1aee81f7ed3958b5356eee14cf8391a98d2888.jpg\" width=\"50%\" /></p>\n<h3>What Is <code>Q</code>?</h3><p>There are numerous promise libraries out there, but Angular ships with one called <a href=\"https://github.com/kriskowal/q\">Q</a>. It is a really nice library and I&#39;ve used it for some of my non-Angular and even some of my Node projects in the past. Angular can inject <code>$q</code> directly, but some of the services, such as the <code>$resource</code> service already use it under the hood.</p>\n<p><img src=\"http://ct.fra.bz/ol/fz/sw/i59/5/9/27/frabz-One-does-Not-Simply-give-a-promise-then-pretend-it-never-happen-2d0ebe.jpg\" width=\"50%\" /></p>\n<h3>Deferring A Promise</h3><p>The syntax for deferring a promise is pretty straightforward. You need to instantiate a new <code>$q.defer()</code> and then return the promise off of the object that it returns. When you&#39;re done doing what you&#39;re doing, you just need to resolve the deferred object. If you have any data that you want to pass into the resolve function, you can pass it as the first argument.</p>\n<pre><code>angular\n    .module(&#39;myApp&#39;)\n    .service(&#39;Wait&#39;, Wait);\n\nWait.$inject = [&#39;$q&#39;, &#39;$window&#39;];\n\nfunction Wait ($q, $window) {\n\n    var service = {};\n\n    service.waitFor = waitFor;\n\n    function waitFor (ms) {\n        var deferred = $q.defer();\n\n        $window.setTimeout(function () {\n            deferred.resolve();\n        }, ms);\n\n        return deferred.promise;\n    }\n\n    return service;\n\n}\n</code></pre><p>The service above could be used like this:</p>\n<pre><code>angular\n    .module(&#39;myApp&#39;)\n    .controller(&#39;MyController&#39;, MyController);\n\nMyController.$inject = [&#39;Wait&#39;];\n\nfunction MyController (Wait) {\n    Wait\n        .waitFor(1000)\n        .then(function () {\n            alerted(&#39;I already waited for a second! I\\&#39;m bored!&#39;);\n        });\n}\n</code></pre><p><img src=\"http://djebbz.github.io/async-paris-js/images/why-so-asynchronous.jpg\" width=\"50%\" /></p>\n<h3>Waiting For Multiple Promises</h3><p>Sometimes, you have multiple promise you want to resolve, but it doesn&#39;t necessarily matter what order the functions are executed in. You just want to execute multiple asynchronous operations and get notified when they are done. For that, we have <code>$q.all</code>. The &quot;all&quot; method takes an array of functions and gives you a callback when they are all completed.</p>\n<p>Using <code>$q.all</code> looks something like this:</p>\n<pre><code>angular\n    .module(&#39;myApp&#39;)\n    .controller(&#39;MyController&#39;, MyController);\n\nMyController.$inject = [&#39;$q&#39;, &#39;$window&#39;];\n\nfunction MyController ($q, $window) {\n\n    $q.all([\n        $q(firstThing()),\n        $q(firstSecond()),\n        $q(thirdThing())\n    ])\n    .then(function (data) {\n        // ...\n    });\n\n    function firstThing () {\n        var deferred = $q.defer();\n\n        $window\n            .setTimeout(deferred.resolve, 1000);\n\n        return deferred.promise;\n    }\n\n    function secondThing () {\n        var deferred = $q.defer();\n\n        $window\n            .setTimeout(deferred.resolve, 2000);\n\n        return deferred.promise;\n    }\n\n    function thirdThing () {\n        var deferred = $q.defer();\n\n        $window\n            .setTimeout(deferred.resolve, 3000);\n\n        return deferred.promise;\n    }\n\n}\n</code></pre><p>Note that the each function you are passing into the array that is the first argument of <code>$q.all</code> method needs to be wrapped in a <code>$q</code>. That might seem a little tedious, but it keeps the functions from executing without a proper callback and in turn breaking the chain.</p>\n<p>There might be a little learning curve with Angular promises, but it is well worth the effort. Promises can go a long way to make cleaner more maintainable code and I&#39;ve found that the implementation in Angular is very solid.</p>\n"},"angular-controller-as":{"published":true,"title":"Ditching $scope For ControllerAs In Angular Apps","tags":["angular"],"category":"code","date":"11/29/2014","thumbnail":"/images/blog/angular-controller-as.jpeg"},"testing-angular-controllers-with-karma":{"published":true,"title":"Testing Angular Controllers With Karma","tags":["angular","karma","unit testing"],"category":"code","date":"10/10/2014","thumbnail":"/images/blog/testing-angular-controllers-with-karma.jpeg"},"new-job-at-aloompa":{"published":true,"title":"My New Job At Aloompa","tags":["jobs","life"],"category":"life","date":"9-24-2014","thumbnail":"/images/blog/aloompa.png"},"getting-started-with-react":{"published":true,"title":"Getting Started With React","tags":["react"],"category":"code","date":"9-08-2014","thumbnail":"/images/blog/react.png"},"automatically-refresh-your-browser-when-your-code-changes-with-bowsersync":{"published":true,"title":"Automatically Refresh Your Browser When Your Code Changes With BrowserSync","tags":["browsers","browsersync"],"category":"code","date":"9-03-2014","thumbnail":"/images/blog/browsersync.png"},"how-to-upload-remote-images-with-sails-js":{"published":true,"title":"How To Upload Remote Images With SailsJS","tags":["sailsjs","amazons3"],"category":"code","date":"8-18-2014","thumbnail":"/images/blog/how-to-upload-remote-images-with-sails-js.png"},"communicating-between-controllers-in-angular":{"published":true,"title":"Communicating Between Controllers In Angular","tags":["angular","pubsub"],"category":"code","date":"8-11-2014","thumbnail":"/images/blog/communicating-between-controllers-in-angular.jpg"},"the-state-of-javascript-a-shift-from-imperative-to-declarative":{"published":true,"title":"The State Of JavaScript - A Shift From Imperative To Declarative","tags":["javascript"],"category":"code","date":"8-04-2014","thumbnail":"/images/blog/the-state-of-javascript-a-shift-from-imperative-to-declarative.jpg"},"using-knockout-for-progressive-enhancement-on-lists":{"published":true,"title":"Progressive Enhancement With the Knockout Foreach Binding","tags":["knockout","progressive-enhancement"],"category":"code","date":"7-28-2014","thumbnail":"/images/blog/using-knockout-for-progressive-enhancement-on-lists.jpg"},"using-knockout-for-progressive-enhancement":{"published":true,"title":"Using Knockout For Progressive Enhancement","tags":["knockout","progressive-enhancement"],"category":"code","date":"7-14-2014","thumbnail":"/images/blog/using-knockout-for-progressive-enhancement.jpg"},"how_to_not_be_a_cyborg_when_you_work_on_computers":{"published":true,"title":"How To Not Be A Cyborg When You Work On Computers","tags":["productivity","working-from-home","work-life-balance"],"category":"productivity","date":"7-03-2014","thumbnail":"/images/blog/cyborg.png"},"syncing-angular-with-sails":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":7,"lastPart":true,"title":"Syncing Angular With Sails","tags":["sailsjs","angular"],"category":"code","date":"6-30-2014","thumbnail":"/images/blog/syncing-angular-with-sails.png"},"sails-models":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":6,"title":"Sails Models","tags":["sailsjs"],"category":"code","date":"6-27-2014","thumbnail":"/images/blog/sails-models.png"},"angular-controllers-with-sails-app":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":5,"title":"Angular Controllers","tags":["angular"],"category":"code","date":"6-12-2014","thumbnail":"/images/blog/angular-controllers-with-sails-app.png","yield":"<div class=\"series-placement\">\n\n    This is part 5 of the <a href=\"/blog/sails-ninja-intro\">Creating An Application With Sails, Angular and Require.js</a> blog series. If you haven&#39;t read the introduction yet, you may want to start there.\n\n    <h4><a href=\"/blog/adding-dependencies\">Previous Post In This Series</a> | <a href=\"/blog/sails-models\">Next Post In This Series</a></h4>\n\n</div>\n\n<p>In the past few posts, I&#39;ve been laying the groundwork for building an Angular application on top of Sails. Now that everything is in place, we can jump right in to adding Angular views.</p>\n<!-- more -->\n<h3>Create the List Route</h3><p>First, we will generate a new controller and model called &quot;list&quot;:</p>\n<pre><code class=\"language-bash\">sails generate list\n</code></pre>\n<p>Next, we will add a link to the list page in our layout.ejs file:</p>\n<pre><code class=\"language-html\">&lt;li class=&quot;&lt;% if (title === &#39;List&#39;) { %&gt;active&lt;% } %&gt;&quot;&gt;\n  &lt;%- link_to(&#39;List&#39;, &#39;/list&#39;) %&gt;\n&lt;/li&gt;\n</code></pre>\n<p>Now, if we open our <code>/api/controllers/ListController.js</code> file, we can add a method to render the index page:</p>\n<pre><code class=\"language-js\">module.exports = {\n  index: function (req, res) {\n    res.view(null, {\n        title: &#39;List&#39;\n    });\n  },\n  _config: {}\n};\n</code></pre>\n<p>Finally, we will create a view for the lists in <code>/views/list/index.ejs</code>:</p>\n<pre><code class=\"language-html\">&lt;ul class=&quot;checklist&quot;&gt;\n    &lt;li&gt;\n        &lt;input type=&quot;checkbox&quot; checked /&gt; Do a thing\n    &lt;/li&gt;\n    &lt;li&gt;\n        &lt;input type=&quot;checkbox&quot; /&gt; Do another thing\n    &lt;/li&gt;\n    &lt;li&gt;\n        &lt;input type=&quot;checkbox&quot; /&gt; Do a third thing\n    &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;button class=&quot;btn btn-primary&quot;&gt;Add&lt;/button&gt;\n&lt;button class=&quot;btn btn-danger&quot;&gt;Remove&lt;/button&gt;\n</code></pre>\n<h3>Add the Angular Controller</h3><p>Now that we&#39;ve got the view rendering for our list, we can add an Angular controller to it.</p>\n<p>We will update the markup for the <code>views/list/index.ejs</code> template to use Angular:</p>\n<pre><code class=\"language-html\">&lt;div ng-controller=&quot;ListCtrl&quot;&gt;\n    &lt;ul class=&quot;checklist&quot;&gt;\n        &lt;li ng-repeat=&quot;item in items&quot;&gt;\n            &lt;input type=&quot;checkbox&quot; ng-checked=&quot;item.completed&quot; /&gt; &lt;span ng-bind=&quot;item.description&quot;&gt;&lt;/span&gt;\n        &lt;/li&gt;\n    &lt;/ul&gt;\n\n    &lt;button class=&quot;btn btn-primary&quot; ng-click=&quot;addItem&quot;&gt;Add&lt;/button&gt;\n    &lt;button class=&quot;btn btn-danger&quot; ng-click=&quot;removeItems&quot;&gt;Remove&lt;/button&gt;\n&lt;/div&gt;\n</code></pre>\n<p>The Angular bindings to take note of are the <code>ng-controller</code>. That will bind everything inside of it to the context of the controller we specified. Next, there is the <code>ng-repeat</code>, which loops over items in the scope.</p>\n<p>Now that we&#39;ve added the controller to the markup, we need to actually create the controller in JavaScript. Let&#39;s look at our <code>/assets/js/app.js</code> file. We&#39;ll need it to update it to look like this:</p>\n<pre><code class=\"language-js\">define([\n  &#39;angular&#39;,\n  &#39;sails.io&#39;,\n  &#39;controllers&#39;\n], function (angular, io) {\n\n  var socket = io.connect(), app;\n\n  socket.on(&#39;connect&#39;, function socketConnected() {\n    console.log(&#39;Socket is now connected&#39;);\n  });\n\n  app = angular.module(&#39;todoIt&#39;, [\n    &#39;controllers&#39;\n  ]);\n\n  return app;\n\n});\n</code></pre>\n<p>Basically, we are requiring a JavaScript file which we haven&#39;t created yet called <code>controllers.js</code>. We are also adding a &quot;controllers&quot; module to our application.</p>\n<p>Now that we&#39;ve got that in place, let&#39;s create the <code>/assets/js/controllers.js</code> file:</p>\n<pre><code class=\"language-js\">define(function (require) {\n\n  var angular = require(&#39;angular&#39;),\n      Controllers = angular.module(&#39;controllers&#39;, []);\n\n  Controllers.controller(&#39;ListCtrl&#39;, require(&#39;controllers/listCtrl&#39;));\n\n  return Controllers;\n\n});\n</code></pre>\n<p>The great thing about the way we&#39;ve set up this file is that anytime we need to add a new controller, it&#39;s as simple as adding one new line. This will require the controller and initialize it.</p>\n<p>Now, we&#39;ll need to create a new directory at <code>/assets/js/controllers</code>. Inside our new folder, we&#39;ll make a file named <code>listCtrl.js</code>. The listCtrl.js file should look like this:</p>\n<pre><code class=\"language-js\">define(function () {\n    return [&#39;$scope&#39;, function($scope) {\n        $scope.addItem = function () {\n            console.log(&#39;addItem&#39;);\n        };\n        $scope.removeItems = function () {\n            console.log(&#39;removeItems&#39;);\n        };\n        $scope.items = [{\n            description: &#39;Do a thing&#39;,\n            completed: true\n        }, {\n            description: &#39;Do another thing&#39;,\n            completed: false\n        }, {\n            description: &#39;Do a third thing&#39;,\n            completed: false\n        }];\n    }];\n});\n</code></pre>\n<p>So there we go. Each of our controller AMD modules will just return an array with the dependencies as the items in the array and a function as the last item, just like a regular Angular controller except the controller is being initialized in the controller.js file, not on an individual module basis.</p>\n<p>We are adding an array of &quot;items&quot; to the <code>$scope</code>. We also went ahead and stubbed out a couple of methods for the buttons. They&#39;ll just do a console.log for now, but we&#39;ll get them working soon.</p>\n<p>Now we have Angular controllers on top of our Sails app. At this point, the app should look something like this:</p>\n<p><img src=\"/images/blog/angular-controllers-with-sails-app2.png\" alt=\"\"></p>\n<p>Next time we&#39;ll start getting real data on the app.</p>\n<p>If you want to see the point our sample app should be at by now, check out the Github repo <a href=\"https://github.com/tysoncadenhead/sails-angular-example-app/tree/12d1e1860f0c1ae5acead7f6011059ce6b637375\">at this point</a>.</p>\n"},"adding-dependencies":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":4,"title":"Adding Dependencies","tags":["sailsjs","angular"],"category":"code","date":"5-30-2014","thumbnail":"/images/blog/adding-the-dependencies.png","yield":"<div class=\"series-placement\">\n\n    This is part 4 of the <a href=\"/blog/sails-ninja-intro\">Creating An Application With Sails, Angular and Require.js</a> blog series. If you haven&#39;t read the introduction yet, you may want to start there.\n\n    <h4><a href=\"/blog/server-side-views\">Previous Post In This Series</a> | <a href=\"/blog/angular-controllers-with-sails-app\">Next Post In This Series</a></h4>\n\n</div>\n\n<p>As I promised at the beginning of this series, we are going to be using <a href=\"http://requirejs.org/\">RequireJS</a> to manage our client-side modules. If you haven&#39;t used RequireJS or a similar AMD loader before, let me just say that you are really missing out. RequireJS lets you write your code in small modules that only expose the parts of the API that you want to show and as an added bonus, it uses JavaScript to load your JavaScript modules.</p>\n<!-- more -->\n<p><img src=\"http://bower.io/img/bower-logo.png\" width=\"250px\" /></p>\n<h4>We Can Use Bower, Right?</h4><p>Before we get started, I wanted to give a quick rant about why using bower in a Sails project hasn&#39;t worked very well for me. <a href=\"http://bower.io\">Bower</a> is a package manager for client-side JavaScript much like <a href=\"http://www.npmjs.com/\">NPM</a> is for server-side JavaScript. Typically, I would use bower to manage my dependencies for any project. The issue is that Sails doesn&#39;t run your assets right out of the folder you create them in. Instead, it packages them up with Grunt and runs them out of <code>.tmp/public</code>. That approach is really helpful if you have a compilation step such as converting SASS or LESS stylesheets to CSS or minifying your JavaScript. The issue is that it if you have a ton of files in your assets directory, as is often the case when you have installed bower packages, you will inevitably either get errors complaining about the number of files being processed or it will be painfully slow. Either way, I&#39;ve come to the painful conclusion that using Bower with Sails is more trouble than it is worth.</p>\n<p>My compromise is typically to load my vendor files from a CDN whenever there is one instead of junking up my project with code that I didn&#39;t write.</p>\n<p><img src=\"http://ianreah.com/img/requirejs-logo.png\" alt=\"RequireJS\"></p>\n<h4>RequireJS</h4><p>There is actually some debate about whether or not RequireJS has value in an Angular project. Angular has a dependency injection concept that makes running the code itself pretty modular. However, it doesn&#39;t load specific files for you out of the box. There are a few ways to leverage the Angular library to load your files for you. To me, though, it seems simpler to follow a set standard like what RequireJS provides by closely following the AMD spec. That way, developers in the future will have a clearer idea of where the code is coming from and how it is being loaded.</p>\n<p>So, let&#39;s get RequireJS working.</p>\n<p>Let&#39;s open the layout.ejs file and add a line to instantiate our Angular application. We will replace the body tag with this:</p>\n<pre><code class=\"language-html\">&lt;body ng-app=&quot;todoIt&quot;&gt;\n</code></pre>\n<p>The name of the app can be whatever you want to call your application, but just be aware that you will be referencing it later in your javaScript.</p>\n<p>Next, we need to go to the bottom of the layout.ejs file and replace all of the JavaScript files with this:</p>\n<pre><code class=\"language-html\">&lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.11/require.min.js&quot; data-main=&quot;/js/main&quot;&gt;&lt;/script&gt;\n</code></pre>\n<p>That will load the require.min.js file from a CDN and then immediately require your <code>/js/main.js</code> file. Don&#39;t have a main.js file yet? No problem. Let&#39;s go ahead and build that.</p>\n<pre><code class=\"language-js\">window.name = &#39;NG_DEFER_BOOTSTRAP!&#39;;\n\nrequire.config({\n  &#39;baseUrl&#39;: &#39;/js&#39;,\n  &#39;paths&#39;: {\n    &#39;angular&#39;: &#39;//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular&#39;,\n    &#39;jquery&#39;: &#39;//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min&#39;,\n    &#39;bootstrap&#39;: &#39;//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min&#39;\n  },\n  &#39;shim&#39;: {\n    &#39;angular&#39;: {\n      &#39;exports&#39;: &#39;angular&#39;\n    },\n    &#39;bootstrap&#39;: {\n      &#39;deps&#39;: [&#39;jquery&#39;]\n    },\n    &#39;socket.io&#39;: {\n      &#39;exports&#39;: &#39;io&#39;\n    },\n    &#39;sails.io&#39;: {\n      &#39;deps&#39;: [&#39;socket.io&#39;],\n      &#39;exports&#39;: &#39;io&#39;\n    }\n  }\n});\n\nrequire([\n  &#39;angular&#39;,\n  &#39;app&#39;,\n  &#39;bootstrap&#39;\n], function (angular, app) {\n\n  angular.element(document.getElementsByTagName(&#39;html&#39;)[0]);\n\n  angular.element().ready(function() {\n    angular.resumeBootstrap([app.name]);\n  });\n\n});\n</code></pre>\n<p>Notice at the top where we set the <code>window.name</code> to &quot;NG_DEFER_BOOTSTRAP!&quot;. That will keep angular from initializing until we tell it to. Near the bottom after everything is loaded, we call angular.resumeBootstrap(). That is where angular picks back up and finishes initializing.</p>\n<p>The socket.io and sails.io files that come with Sails are not wrapped as AMD modules, so we need to shim them both and export the io variable.</p>\n<p>Otherwise, the main.js is pretty standard for a requireJS config file. </p>\n<p>We will also need to update the app.js file to this:</p>\n<pre><code class=\"language-js\">define([\n  &#39;angular&#39;,\n  &#39;sails.io&#39;\n], function (angular, io) {\n\n  var socket = io.connect(), app;\n\n  socket.on(&#39;connect&#39;, function socketConnected() {\n    console.log(&#39;Socket is now connected&#39;);\n  });\n\n  app = angular.module(&#39;todoIt&#39;, []);\n\n  return app;\n\n});\n</code></pre>\n<p>We are leaving the socket.io connection. We&#39;ll be working with that later on. For now, we mostly just want to return our app as a new angular module. Notice that the name &quot;todoIt&quot; is the same as the <code>ng-app</code> that we added to our layout.ejs file.</p>\n<p>Now the main.js file will take the app that is returned from app.js and create an angular application.</p>\n<p>When you look at your console at this point, you should get a message that says:</p>\n<pre><code class=\"language-bash\">Socket is now connected\n</code></pre>\n<p>If you see that and don&#39;t get any errors, you have successfully added an angular application on top of Sails. Stay tuned next time when we make the application actually do something.</p>\n<p>If you want to see the code in action, check out the example repository <a href=\"https://github.com/tysoncadenhead/sails-angular-example-app/tree/ffc98437c91b4bf154c9619fd50b103c9549a465\">here</a>.</p>\n"},"server-side-views":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":3,"title":"Sails Server-Side Views","tags":["sailsjs"],"category":"code","date":"5-21-2014","thumbnail":"/images/blog/server-side-views.png"},"starting_the_sails_project":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":2,"title":"Starting a Sails Project","tags":["sailsjs"],"category":"code","date":"5-2-2014","thumbnail":"/images/blog/starting_the_sails_project.jpg"},"sails-ninja-intro":{"published":true,"series":"Creating An Application With Sails, Angular and Require.js","part":1,"firstPart":true,"title":"Introduction","tags":["sailsjs","angular"],"category":"code","date":"4-25-2014","thumbnail":"/images/blog/sails-ninja-intro.jpg"},"using-facebook-authentication-on-a-sails-js-app":{"published":true,"title":"Facebook Authentication With Sails.js and Passport","tags":["sailsjs","facebook","authentication"],"category":"code","date":"4-10-2014","thumbnail":"/images/blog/using-facebook-authentication-on-a-sails-js-app.jpg","slug":"using-facebook-authentication-on-a-sails-js-app"},"unit-testing-sails-js-applications-with-mocha":{"published":true,"title":"Unit Testing Sails.js Applications With Mocha","tags":["sailsjs","testing","mocha"],"category":"code","date":"4-04-2014","thumbnail":"/images/blog/unit-testing-sails-js-applications-with-mocha.jpg"},"deploying-harp-builds-to-github-pages":{"published":true,"title":"Deploying Harp.js Builds To Github Pages","tags":["html","node","terminal"],"category":"code","date":"3-25-2014","thumbnail":"/images/blog/deploying-harp-builds-to-github-pages.jpg"},"squash-stretch-and-bounce-with-css3-animations":{"published":true,"title":"Squash, Stretch and Bounce With CSS3 Animations","tags":["css"],"category":"code","date":"3-19-2014","thumbnail":"/images/blog/squash-stretch-and-bounce-with-css3-animations.jpg"},"how-to-abstract-pub-sub-in-your-application":{"published":true,"title":"How To Abstract Pub / Sub Methods In Your Application","tags":["javascript","pubsub"],"category":"code","date":"3-18-2014","thumbnail":"/images/blog/how-to-abstract-pub-sub-in-your-application.jpg"},"exporting-canvas-animation-to-mov":{"published":true,"title":"Exporting Three JS Canvas Animations To MOV or MP4 Format With Socket.io","tags":["node","javascript","animation"],"category":"code","date":"3-17-2014","thumbnail":"/images/blog/exporting-canvas-animation-to-mov.jpg"},"javascript-life-ko-ninja-example-app":{"published":true,"title":"Ko.Ninja Example App - JavaScript Life","tags":["knockout","javascript","ko.ninja"],"category":"code","date":"3-14-2014","thumbnail":"/images/blog/javascript-life-ko-ninja-example-app.jpg"},"the-correct-way-to-use-jquery-with-knockout-js":{"published":true,"title":"The Correct Way To Use JQuery With Knockout","tags":["knockout","jquery","javascript"],"category":"code","date":"3-12-2014","thumbnail":"/images/blog/the-correct-way-to-use-jquery-with-knockout-js.jpg"},"the-business-case-for-having-an-all-remote-organization":{"published":true,"title":"The Business Case For Having An All-Remote Organization","tags":["remote"],"category":"productivity","date":"3-7-2014","thumbnail":"/images/blog/the-business-case-for-having-an-all-remote-organization.jpg","slug":"the-business-case-for-having-an-all-remote-organization"},"how-to-organize-a-meteor-app":{"published":true,"title":"How To Organize A Meteor App","tags":["meteor"],"category":"code","date":"3-6-2014","thumbnail":"/images/blog/how-to-organize-a-meteor-app.jpg"},"there-is-more-than-one-way-to-loop-a-cat":{"published":true,"title":"There Is More Than One Way To Loop Over A Cat","tags":["looping","underscore","jquery"],"category":"code","date":"2-22-2014","thumbnail":"/images/blog/there-is-more-than-one-way-to-loop-a-cat.jpg","slug":"there-is-more-than-one-way-to-loop-a-cat"},"dependency-injection-with-squire-and-sinon":{"published":true,"title":"Dependency Injection With Squire and Sinon","tags":["testing","squire"],"category":"code","date":"2-7-2014","thumbnail":"/images/blog/dependency-injection-with-squire-and-sinon.jpg"},"dom-manipulation-is-so-early-2000s":{"published":true,"title":"DOM Manipulation Is So Early 2000s","tags":["jQuery","Knockout"],"category":"code","date":"1-31-2014","thumbnail":"/images/blog/dom-manipulation-is-so-early-2000s.jpg"},"ko-ninja-socket-io-model":{"published":true,"series":"Ko.Ninja","part":5,"lastPart":true,"title":" Socket.io Models","tags":["knockout","ko.ninja","model","data","socket.io"],"category":"code","date":"1-17-2014","thumbnail":"/images/blog/ninja5.png"},"ko-ninja-http-models":{"published":true,"series":"Ko.Ninja","part":4,"title":"HTTP Models","tags":["knockout","ko.ninja","model","data","ajax"],"category":"code","date":"1-9-2014","thumbnail":"/images/blog/ninja4.png"},"ko-ninja-model":{"published":true,"series":"Ko.Ninja","part":3,"title":"LocalStorage Models","tags":["knockout","ko.ninja","model","data","ajax"],"category":"code","date":"1-2-2014","thumbnail":"/images/blog/ninja3.png"},"ko-ninja-validation":{"published":true,"series":"Ko.Ninja","part":2,"title":"Validation","tags":["knockout","ko.ninja","validation"],"category":"code","date":"12-27-2013","thumbnail":"/images/blog/ninja2.png"},"ko-ninja":{"published":true,"series":"Ko.Ninja","part":1,"firstPart":true,"title":"A Framework For Building Awesome Knockout.js Apps","tags":["knockout","ko.ninja"],"category":"code","date":"12-20-2013","thumbnail":"/images/blog/ninja1.png"},"how-to-use-tor-with-chrome":{"published":true,"title":"How To Use Tor With Google Chrome","tags":["Security","Browsers","Tor","Privacy"],"category":"privacy","date":"11-22-2013","thumbnail":"/images/blog/tor.png"},"authentication-in-meteor":{"published":true,"title":"Authentication in Meteor","tags":["Meteor","Node","Authentication"],"category":"code","date":"11-14-2013","thumbnail":"/images/blog/meteor-authentication.png"},"why-you-should-teach-your-kids-to-write-code":{"published":true,"title":"Why You Should Teach Your Kids How to Write Code","tags":["Rant","Kids"],"category":"code","date":"11-08-2013","thumbnail":"/images/blog/duck.jpg"},"javascript-copy-and-paste-events":{"published":true,"title":"The JavaScript Copy and Paste Events","tags":["JavaScript"],"category":"code","date":"10-31-2013","thumbnail":"/images/blog/clippy.jpg"},"getting-started-with-socket-io":{"published":true,"title":"Getting Started with Socket.io","tags":["node","socketio","javascript"],"category":"code","date":"10-25-2013","thumbnail":"/images/blog/socket-io.jpg"},"working-with-meteor-data":{"published":true,"title":"Working with Meteor Data","tags":["Meteor","Node","JavaScript","Data"],"category":"code","date":"10-10-2013","thumbnail":"/images/blog/meteor-data.png"},"why-is-test-driven-development-so-hard":{"published":true,"title":"Why is Test-Driven Development So Hard?","tags":["TDD","Test Driven Development","Unit Testing"],"category":"code","date":"10-4-2013","thumbnail":"/images/blog/tdd.png"},"getting-started-with-meteor":{"published":true,"title":"Getting Started with Meteor","tags":["Meteor","Node","JavaScript"],"category":"code","date":"9-26-2013","thumbnail":"/images/blog/meteor.png"},"creating-sprites-with-compass":{"published":true,"title":"Creating Sprites with Compass","tags":["Compass","SASS","CSS"],"category":"code","date":"9-20-2013","thumbnail":"/images/blog/sprite.png"},"how-to-build-grunt-from-sublime-text":{"published":true,"title":"How to Do a Grunt Build Using Sublime Text","tags":["Grunt","Sublime"],"category":"code","date":"9-13-2013","thumbnail":"/images/blog/grunt-sublime.png"},"secrets-of-the-javascript-ninja":{"published":true,"title":"Book Review: Secrets of the JavaScript Ninja","tags":["Book","JavaScript"],"category":"code","date":"9-4-2013","thumbnail":"/images/blog/ninja.png"},"compiling-sass-and-compass-with-grunt":{"published":true,"title":"Compiling SASS and Compass with Grunt","tags":["SASS","Compass","Grunt"],"category":"code","date":"8-30-2013","thumbnail":"/images/blog/grunt-sass.png"},"how-can-you-see-the-latest-poet-js-posts-without-restarting-the-server":{"published":true,"title":"How Can You See the Latest Poet.js Posts Without Restarting the Server?","tags":["NodeJS","Blogging"],"category":"code","date":"8-23-2013","thumbnail":"/images/blog/poet-latest.png"},"sencha-architect-app-development":{"published":true,"title":"Book Review: Sencha Architect App Development","tags":["Book"],"category":"code","date":"8-16-2013","thumbnail":"/images/blog/senchabook3.png"},"poet-js":{"published":true,"title":"Getting Started with Poet.js","tags":["NodeJS","Blogging"],"category":"code","date":"8-9-2013","thumbnail":"/images/blog/poet.png"},"client-side-dependency-management-with-bower":{"published":true,"title":"Client-Side Dependency Management with Bower","tags":["Bower"],"category":"code","date":"8-2-2013","thumbnail":"/images/blog/bower.png"},"logging-time-on-the-developer-console":{"published":true,"title":"Logging Time on the Developer Console","tags":["JavaScript"],"category":"code","date":"7-29-2013","thumbnail":"/images/blog/time.png"},"javascript-test-coverage-with-jscoverage":{"published":true,"title":"Determining JavaScript Test Coverage with JSCover","tags":["Testing"],"category":"code","date":"7-18-2013","thumbnail":"/images/blog/cover.png"},"localstorage-with-amplify-js":{"published":true,"title":"LocalStorage with Amplify.js","tags":["LocalStorage","appendTo"],"category":"code","date":"7-13-2013","thumbnail":"/images/blog/amplify.png"},"running-node-applications-continuously-with-foreverjs":{"published":true,"title":"Running Node Applications Continuously with Forever.js","tags":["Node"],"category":"code","date":"7-5-2013","thumbnail":"/images/blog/forever.png"},"gardening-for-web-developers":{"published":true,"title":"Gardening for Web Developers","tags":["Code"],"category":"code","date":"6-28-2013","thumbnail":"/images/blog/gardening.jpg"},"bing-translate-a-new-grunt-task-to-internationalize-your-apps-programmatically":{"published":true,"title":"Bing Translate: A New Grunt Task to Internationalize Your Apps Programmatically","tags":["Grunt","Bing","Bing Translator","i18n"],"category":"code","date":"6-21-2013","thumbnail":"/images/blog/grunt.png"},"what-should-i-test-when-i-write-software":{"published":true,"title":"What Should I Test When I Write Software?","tags":["Testing","Mocha","QUnit","Selenium"],"category":"code","date":"6-6-2013","thumbnail":"/images/blog/test-dummy.png"},"jquery-jsontemplate":{"published":true,"title":"Instroducing jQuery.jsonTemplate","tags":["JSON","Template"],"category":"code","date":"6-3-2013","thumbnail":"/images/blog/layout.png"},"do-you-need-a-college-degree-to-be-a-web-developer":{"published":true,"title":"Do You Need a College Degree to Be a Web Developer?","tags":["College","Coding"],"category":"code","date":"5-25-2013","thumbnail":"/images/blog/graduate.jpg"},"compound-js-presentation-in-nashville":{"published":true,"title":"Compound JS Presentation in Nashville","tags":["Compound","Presentation"],"category":"code","date":"5-22-2013","thumbnail":"/images/blog/testtubes.png"},"creating-mobile-apps-with-sencha-touch-2":{"published":true,"title":"Book Review: Creating Mobile Apps With Sencha Touch 2","tags":["Book","Sencha"],"category":"code","date":"5-16-2013","thumbnail":"/images/blog/senchabook.png"},"using-local-storage-in-sencha-touch-2-2":{"published":true,"title":"Using Local Storage in Sencha Touch 2.2","tags":["Sencha","LocalStorage"],"category":"code","date":"4-19-2013","thumbnail":"/images/blog/storage.jpg"},"knockout-observables":{"published":true,"title":"Knockout Observables","tags":["Knockout"],"category":"code","date":"4-8-2013","thumbnail":"/images/blog/observers.png"},"authentication-with-compound-passport":{"published":true,"title":"Authentication with Compound-Passport","tags":["Compound","Node","Authentication"],"category":"code","date":"4-3-2013","thumbnail":"/images/blog/passport.png"},"unit-testing-with-thrill-js":{"published":true,"title":"Unit Testing with Thrill.js","tags":["Thrill","Queen","Testing","QUnit"],"category":"code","date":"4-1-2013","thumbnail":"/images/blog/thrill.png"},"executeasyncscript-in-selenium-webdriver-for-node":{"published":true,"title":"executeAsyncScript() in Selenium Webdriver for Node","tags":["Testing","Selenium"],"category":"code","date":"3-22-2013","thumbnail":"/images/blog/selenium.png"},"compoundjs-routes":{"published":true,"title":"Compound.js Routes","tags":["Compound"],"category":"code","date":"3-12-2013","thumbnail":"/images/blog/car.png"},"what-are-the-best-productivity-apps-for-osx":{"published":true,"title":"What are the Best Productivity Apps for OSX?","tags":["Productivity","OSX"],"category":"productivity","date":"3-5-2013","thumbnail":"/images/blog/multitasking.png"},"how-do-yo-make-a-compoundjs-app":{"published":true,"title":"How Do You Make a Compound.js Application?","tags":["Compound"],"category":"code","date":"2-27-2013","thumbnail":"/images/blog/compound.png"},"how-do-you-write-an-anvil-js-plugin":{"published":true,"title":"How Do You Write an Anvil.js Plugin?","tags":["Anvil","Build"],"category":"code","date":"2-21-2013","thumbnail":"/images/blog/anvil.png"},"what-is-jquery-map":{"published":true,"title":"What is jQuery.map?","tags":["jQuery","JavaScript"],"category":"code","date":"2-15-2013","thumbnail":"/images/blog/map.png"},"getting-the-most-out-of-your-time":{"published":true,"title":"Getting the Most Out of Your Time","tags":["Productivity"],"category":"productivity","date":"2-4-2013","thumbnail":"/images/blog/machine.png"},"hosting-multiple-websites-on-the-same-wordpress-installation":{"published":true,"title":"Hosting Multiple Websites on the Same WordPress Installation","tags":["Wordpress"],"category":"code","date":"1-28-2013","thumbnail":"/images/blog/wordpress.png"},"top-10-backbone-plugins":{"published":true,"title":"Top 5 Backbone Plugins","tags":["Backbone","JavaScript"],"category":"code","date":"1-22-2013","thumbnail":"/images/blog/plugin.png"},"how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side":{"published":true,"title":"How Do I Share EJS Templates Between the Client-side and the Server-side?","tags":["EJS","Templates","Node","JavaScript"],"category":"code","date":"1-15-2013","thumbnail":"/images/blog/sharing.png"},"underscore-fire":{"published":true,"title":"_.fire(): A Plugin for Underscore","tags":["Underscore","JavaScript","Open Source"],"category":"code","date":"1-9-2013","thumbnail":"/images/blog/fire.png","slug":"underscore-fire"},"resolutions-2013":{"published":true,"title":"2013 Resolutions","tags":["Goals"],"category":"productivity","date":"1-1-2013","thumbnail":"/images/blog/setgoals.png"},"off-the-charts-jquery-toastchart-plugin":{"published":true,"title":"Introducing the jQuery ToastChart Plugin","tags":["JQuery","JavaScript","Open Source"],"category":"code","date":"12-9-2012","thumbnail":"/images/blog/charts.png"},"my-new-standup-desk":{"published":true,"title":"My New Standup Desk","tags":["Health"],"category":"health","date":"11-17-2012","thumbnail":"/images/blog/standingdesk.png"},"cross-domain-post-delete-and-pu":{"published":true,"title":"Cross-Domain Ajax Using POST, DELETE and PUT Methods","tags":["JavaScript","Ajax"],"category":"code","date":"10-17-2012","thumbnail":"/images/blog/communication.png"},"open-sourcing-some-javascript-libraries":{"published":true,"title":"Open-Sourcing Various JavaScript Libraries","tags":["Goals"],"category":"code","date":"9-7-2012","thumbnail":"/images/blog/confused.png","slug":"open-sourcing-some-javascript-libraries"},"book-review-html5-for-web-designers":{"published":true,"title":"Book Review: HTML5 for Web Designers","tags":["Book","HTML"],"category":"code","date":"1-23-2012","thumbnail":"/images/blog/reading.png"},"writing-a-good-api":{"published":true,"title":"Writing a Good API","tags":["JavaScript"],"category":"code","date":"12-17-2011","thumbnail":"/images/blog/api.png"},"detecting-javascript-popup-blockers":{"published":true,"title":"Detecting JavaScript Popup Blockers","tags":["JavaScript"],"category":"code","date":"10-10-2011","thumbnail":"/images/blog/popup.png"},"do-javascript-libraries-need-an-abstraction-layer":{"published":true,"title":"Do JavaScript Libraries Need an Abstraction Layer?","tags":["JavaScript"],"category":"code","date":"1-21-2011","thumbnail":"/images/blog/abstract.jpg"},"parsing-coldfusion-json-on-the-client-side":{"published":true,"title":"Parsing Coldfusion JSON on the Client-side","tags":["JavaScript","Coldfusion"],"category":"code","date":"8-6-2011","thumbnail":"/images/blog/eskimo.png"},"fat-models-and-skinny-controllers-in-javascript":{"published":true,"title":"Fat Models and Skinny Controllers in JavaScript","tags":["JavaScript","Architecture"],"category":"code","date":"7-14-2011","thumbnail":"/images/blog/controller.png"},"making-browser-specific-css-less-intrusive-with-sass":{"published":true,"title":"Making Browser-Specific CSS Less Intrusive with SASS","tags":["CSS","SASS"],"category":"code","date":"5-30-2011","thumbnail":"/images/blog/browsers.png"},"writing-javascript-for-speed":{"published":true,"title":"Writing JavaScript for Speed","tags":["JavaScript"],"category":"code","date":"4-9-2011","thumbnail":"/images/blog/running.jpg"},"jquery-event-listening":{"published":true,"title":"jQuery Event Listening","tags":["JavaScript"],"category":"code","date":"4-1-2011","thumbnail":"/images/blog/listening.jpg"},"writing-markup-for-future-enhancement":{"published":true,"title":"Writing Markup for Future Enhancement","tags":["HTML"],"category":"code","date":"3-24-2011","thumbnail":"/images/blog/robot.png"},"what-does-a-successful-ajax-application-need":{"published":true,"title":"What Does a Successful JavaScript Application Need?","tags":["JavaScript"],"category":"code","date":"3-11-2011","thumbnail":"/images/blog/success.jpg"},"web-developers-and-health":{"published":true,"title":"Web Developers and Health","tags":["Apps","Health"],"category":"health","date":"3-6-2011","thumbnail":"/images/blog/weights.jpg"},"replacing-href-attributes-with-onclick-events-with-regex":{"published":true,"title":"Replacing href attributes with onClick events with Regex","tags":["JavaScript","Regex"],"category":"code","date":"2-23-2011","thumbnail":"/images/blog/onclick.jpg","slug":"replacing-href-attributes-with-onclick-events-with-regex"},"dont-be-a-user-interface-hoarder":{"published":true,"title":"Don’t Be a User Interface Hoarder","tags":["User Interface"],"category":"design","date":"2-19-2011","thumbnail":"/images/blog/hoarder.jpg"},"jquery-mobile-vs-sencha-touch":{"published":true,"title":"jQuery Mobile vs. Sencha Touch","tags":["Mobile","jQuery Mobile","Sencha Touch"],"category":"code","date":"2-17-2011","thumbnail":"/images/blog/mugs.jpg"},"javascript-variable-casing-best-practices":{"published":true,"title":"JavaScript Variable Casing Best Practices","tags":["JavaScript"],"category":"code","date":"2-8-2011","thumbnail":"/images/blog/casing.jpg"},"script-loaders":{"published":true,"title":"Script Loaders","tags":["JavaScript"],"category":"code","date":"1-1-2011","thumbnail":"/images/blog/loader.jpg"},"putting-ext-mvc-on-hold":{"published":true,"title":"Putting EXT MVC on Hold","tags":["EXT","Architecture"],"category":"code","date":"1-1-2011","thumbnail":"/images/blog/stop.jpg"},"mvc-and-extjs-–-2-config":{"published":true,"title":"Configuration For EXTJS MVC Applications","tags":["EXT","Architecture"],"category":"code","date":"11-1-2010","thumbnail":"/images/blog/2.png"},"mvc-and-extjs-1-introduction":{"published":true,"title":"Getting Started with MVC and EXTJS","tags":["EXT","Architecture"],"category":"code","date":"10-20-2010","thumbnail":"/images/blog/1.png","slug":"mvc-and-extjs-1-introduction"},"sencha-loading-in-the-iphone-4g":{"published":true,"title":"Sencha Loading in the iPhone 4","tags":["Sencha Touch"],"category":"code","date":"10-19-2010","thumbnail":"/images/blog/loading.png"},"javascript-variables-accessibility":{"published":true,"title":"Javascript Variables' Accessibility","tags":["JavaScript"],"category":"code","date":"8-24-2010","thumbnail":"/images/blog/wheelchair.png"},"sencha-application-event-listening":{"published":true,"title":"Sencha Application Event Listening","tags":["Sencha Touch","EXT"],"category":"code","date":"7-17-2010","thumbnail":"/images/blog/senchalistening.png"},"should-i-use-a-javascript-framework":{"published":true,"title":"Should I Use a JavaScript Framework?","tags":["JavaScript"],"category":"code","date":"6-12-2010","thumbnail":"/images/blog/framework.png"},"seo-safe-links-with-an-ajax-callback":{"published":true,"title":"SEO-Safe Links with an Ajax Callback","tags":["JavaScript","HTML","jQuery"],"category":"code","date":"4-8-2010","thumbnail":"/images/blog/seosafe.png"},"javascriptmvc":{"published":true,"title":"Getting Started with JavaScript MVC","tags":["JavaScript","JavaScriptMVC"],"category":"code","date":"3-30-2010","thumbnail":"/images/blog/mvc.png"},"javascript-architecture":{"published":true,"title":"Javascript Architecture","tags":["JavaScript","Architecture"],"category":"code","date":"3-11-2010","thumbnail":"/images/blog/architecture.png"},"links-and-user-experience":{"published":true,"title":"Links and User Experience","tags":["User Experience","Design"],"category":"design","date":"2-21-2010","thumbnail":"/images/blog/links.png"},"what-is-user-experience-user-interface":{"published":true,"title":"What is UI / UX?","tags":["Design","UI","UX"],"category":"design","date":"2-11-2010","thumbnail":"/images/blog/uiux.png"},"what-google-looks-for":{"published":true,"title":"Search Engine Optimization 101","tags":["SEO"],"category":"code","date":"1-29-2010","thumbnail":"/images/blog/search.png"},"code-seperation":{"published":true,"title":"Code Separation","tags":["Architecture"],"category":"code","date":"1-28-2010","thumbnail":"/images/blog/seperation.png"},"killing-ie6":{"published":true,"title":"Killing IE6","tags":["Browsers"],"category":"code","date":"1-27-2010","thumbnail":"/images/blog/ie6.png"}};
</script>

<div class="span8">

<article>

    <div class="well span2 left thumbnail  thumbnail-main">
      <img src="/images/blog/angular-promises.png" />
    </div>

    <h1>A Crash Course On Angular Promises</h1>

    

    <h5><span class="label label-info"><a href="/?category=code">code</a></span> | 12/22/2014</h5>

    <p>Writing complex behaviors in an asynchronous language like JavaScript can be a bit of a challenge. If you aren&#39;t careful, you can make some pretty ugly nested code in order to get things to work like you expect. To solve the problem of illegible nested callbacks, we have promises. If you are writing applications in Angular, you are in luck because Angular ships with a great promise library called &quot;Q&quot;. Today, we&#39;re going to look at a few approaches to making more readable and maintainable Angular applications with the help of the built in Q promise library.</p>
<!-- more -->
<p><img src="http://cdn.meme.am/instances/500x/54391964.jpg" width="50%" alt=""></p>
<h3>What Are Promises?</h3><p>In the distant past, I have been guilty of writing things like this:</p>
<pre><code>myModels.getPerson({ id: 1 }, function (person) {
   myModels.getDad(person, function (dad) {
        myModels.getPet(dad, function (pet) {
            myModels.getPetColor(pet, function (color) {
                // ...
            });
        });
   });
});
</code></pre><p>It looks really ugly, but there were instances where I needed to make one asynchronous operation, then based on the data that I got back from the operation, I would need to make another operation and the tunnel of madness would begin. Promises are an answer to that problem.</p>
<p>Whether you know it or not, you&#39;ve probably been exposed to promises inside of libraries like jQuery when you tack a <code>then()</code> method on after a function.</p>
<p>The way it works is that the function returns a &quot;promise&quot; instead of a result. Inside the function, the promise can be resolved at some point and the <code>then()</code> method is fired which continues the chain of methods you are building.</p>
<p>Taking our contrived example above, if we were using promises, it might look more like this:</p>
<pre><code>myModels
    .getPerson({
        id: 1
    })
    .then(myModels.getDad)
    .then(myModels.getPet)
    .then(myModels.getPetColor)
    .done(function (data) {
        // ...
    });
</code></pre><p>Now we&#39;ve got an API that is readable and maintainable. Life is good again.</p>
<p><img src="http://www.quickmeme.com/img/01/015f8f78101fcf7e97a3b9492a1aee81f7ed3958b5356eee14cf8391a98d2888.jpg" width="50%" /></p>
<h3>What Is <code>Q</code>?</h3><p>There are numerous promise libraries out there, but Angular ships with one called <a href="https://github.com/kriskowal/q">Q</a>. It is a really nice library and I&#39;ve used it for some of my non-Angular and even some of my Node projects in the past. Angular can inject <code>$q</code> directly, but some of the services, such as the <code>$resource</code> service already use it under the hood.</p>
<p><img src="http://ct.fra.bz/ol/fz/sw/i59/5/9/27/frabz-One-does-Not-Simply-give-a-promise-then-pretend-it-never-happen-2d0ebe.jpg" width="50%" /></p>
<h3>Deferring A Promise</h3><p>The syntax for deferring a promise is pretty straightforward. You need to instantiate a new <code>$q.defer()</code> and then return the promise off of the object that it returns. When you&#39;re done doing what you&#39;re doing, you just need to resolve the deferred object. If you have any data that you want to pass into the resolve function, you can pass it as the first argument.</p>
<pre><code>angular
    .module(&#39;myApp&#39;)
    .service(&#39;Wait&#39;, Wait);

Wait.$inject = [&#39;$q&#39;, &#39;$window&#39;];

function Wait ($q, $window) {

    var service = {};

    service.waitFor = waitFor;

    function waitFor (ms) {
        var deferred = $q.defer();

        $window.setTimeout(function () {
            deferred.resolve();
        }, ms);

        return deferred.promise;
    }

    return service;

}
</code></pre><p>The service above could be used like this:</p>
<pre><code>angular
    .module(&#39;myApp&#39;)
    .controller(&#39;MyController&#39;, MyController);

MyController.$inject = [&#39;Wait&#39;];

function MyController (Wait) {
    Wait
        .waitFor(1000)
        .then(function () {
            alerted(&#39;I already waited for a second! I\&#39;m bored!&#39;);
        });
}
</code></pre><p><img src="http://djebbz.github.io/async-paris-js/images/why-so-asynchronous.jpg" width="50%" /></p>
<h3>Waiting For Multiple Promises</h3><p>Sometimes, you have multiple promise you want to resolve, but it doesn&#39;t necessarily matter what order the functions are executed in. You just want to execute multiple asynchronous operations and get notified when they are done. For that, we have <code>$q.all</code>. The &quot;all&quot; method takes an array of functions and gives you a callback when they are all completed.</p>
<p>Using <code>$q.all</code> looks something like this:</p>
<pre><code>angular
    .module(&#39;myApp&#39;)
    .controller(&#39;MyController&#39;, MyController);

MyController.$inject = [&#39;$q&#39;, &#39;$window&#39;];

function MyController ($q, $window) {

    $q.all([
        $q(firstThing()),
        $q(firstSecond()),
        $q(thirdThing())
    ])
    .then(function (data) {
        // ...
    });

    function firstThing () {
        var deferred = $q.defer();

        $window
            .setTimeout(deferred.resolve, 1000);

        return deferred.promise;
    }

    function secondThing () {
        var deferred = $q.defer();

        $window
            .setTimeout(deferred.resolve, 2000);

        return deferred.promise;
    }

    function thirdThing () {
        var deferred = $q.defer();

        $window
            .setTimeout(deferred.resolve, 3000);

        return deferred.promise;
    }

}
</code></pre><p>Note that the each function you are passing into the array that is the first argument of <code>$q.all</code> method needs to be wrapped in a <code>$q</code>. That might seem a little tedious, but it keeps the functions from executing without a proper callback and in turn breaking the chain.</p>
<p>There might be a little learning curve with Angular promises, but it is well worth the effort. Promises can go a long way to make cleaner more maintainable code and I&#39;ve found that the implementation in Angular is very solid.</p>


    <br /><br />

    <div class="bio">
      <div class="span2">
        <img src="/images/about/tyson5.jpg" class="lazy" />
      </div>
      <div class="span5">
        <h3><a href="/about">About the Author</a></h3>
        <p><strong>Tyson Cadenhead</strong> is a Senior JavaScript Developer at <a href="http://aloompa.com">Aloompa</a>. He lives in the greater Nashville area. His specialty is writing large, scalable JavaScript applications on the client and server side. His passions are for good design, usability, and clean, reusable code.</p>
      </div>
    </div>

    <h5>Tags: 
    
        <span class="label">
            <a href="/?tag=angular">angular</a>
        </span>
    
        <span class="label">
            <a href="/?tag=promises">promises</a>
        </span>
    
    </h5>

</article>

<div class="share">
    <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
    </div>
</div>

<h3>Related Posts:</h3>

<div class="span12 related-posts">

  <div class="span2 well thumbnail">
    
    <a href="/blog/mvc-and-extjs-1-introduction"><img src="/images/blog/1.png" /></a>
    <h5>
      <a href="/blog/mvc-and-extjs-1-introduction">Getting Started with MVC and EXTJS</a>
    </h5>
  </div>

  <div class="span2 well thumbnail">
    
    <a href="/blog/making-browser-specific-css-less-intrusive-with-sass"><img src="/images/blog/browsers.png" /></a>
    <h5>
      <a href="/blog/making-browser-specific-css-less-intrusive-with-sass">Making Browser-Specific CSS Less Intrusive with SASS</a>
    </h5>
  </div>

  <div class="span2 well thumbnail">
    
    <a href="/blog/how-can-you-see-the-latest-poet-js-posts-without-restarting-the-server"><img src="/images/blog/poet-latest.png" /></a>
    <h5>
      <a href="/blog/how-can-you-see-the-latest-poet-js-posts-without-restarting-the-server">How Can You See the Latest Poet.js Posts Without Restarting the Server?</a>
    </h5>
  </div>

  <div class="span2 well thumbnail">
    
    <a href="/blog/putting-ext-mvc-on-hold"><img src="/images/blog/stop.jpg" /></a>
    <h5>
      <a href="/blog/putting-ext-mvc-on-hold">Putting EXT MVC on Hold</a>
    </h5>
  </div>

</div>

<div class="google-things">

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-5130799763611680"
       data-ad-slot="1525472392"
       data-ad-format="auto"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  </div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'tysoncadenhead';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>

<div class="well span3 right overflow-auto">

  <h3>Don't Miss Anything!</h3>
  <h5>Sign Up For My Email Newsletter</h5>

  <!-- Begin MailChimp Signup Form -->
  <link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
  <style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
    /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
       We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
  </style>
  <div id="mc_embed_signup">
  <form action="//tysoncadenhead.us9.list-manage.com/subscribe/post?u=97e25799111f2cec4dc714a43&amp;id=501ae643d4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
      <div id="mc_embed_signup_scroll">
    <label for="mce-EMAIL">Subscribe to our mailing list</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;"><input type="text" name="b_97e25799111f2cec4dc714a43_501ae643d4" tabindex="-1" value=""></div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
      </div>
  </form>
  </div>

  <!--End mc_embed_signup-->

  <h3>I Wrote a Book!</h3>

  <iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=US&source=ac&ref=tf_til&ad_type=product_link&tracking_id=tysolloycade-20&marketplace=amazon&region=US&placement=B016QFJVZ2&asins=B016QFJVZ2&linkId=KNSB4DOAIGOWDCDD&show_border=false&link_opens_in_new_window=true&price_color=333333&title_color=115D5A&bg_color=EFEEEE"></iframe>

  <h3>Popular Posts</h3>

  <div id="popular-posts"></div>

</div>

                    
                
            </div>
        </div>
        <script data-main="/js/app.js" src="/js/vendor/require.js"></script>
        <div class="footer">
            <div class="container">
                <div class="addthis_default_style span12 addthis_32x32_style">
                    <a class="addthis_button_facebook_follow" addthis:userid="tysoncadenhead"></a>
                    <a class="addthis_button_twitter_follow" addthis:userid="tysoncadenhead"></a>
                    <a class="addthis_button_linkedin_follow" addthis:userid="tysoncadenhead"></a>
                    <a class="addthis_button_google_follow" addthis:userid="tysoncadenhead"></a>
                    <a class="addthis_button_youtube_follow" addthis:userid="tysoncadenhead"></a>
                    <a href="http://tysoncadenhead.deviantart.com/gallery/" title="Deviant Art" target="_blank" class="deviant-art"></a>
                    <a class="addthis_button_flickr_follow" addthis:userid="tysonlloydcadenhead"></a>
                    <a class="addthis_button_instagram_follow" addthis:userid="tysoncadenhead"></a>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            window.tysonJS = {
                slug: ''
            };
        </script>
    </body>
</html>
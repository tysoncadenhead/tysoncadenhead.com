<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>How Do I Share EJS Templates Between the Client-side and the Server-side?</title>
    <meta name="google-site-verification" content="AeV4w7EOhEv3lU1OT8KOM7jRS0C6jDAsZyMaG38t1g4">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/amp/">
    
    <meta property="og:site_name" content="Tyson Cadenhead">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How Do I Share EJS Templates Between the Client-side and the Server-side?">
    <meta property="og:description" content="The release of Node.js in 2009 ushered in discussions about the endless possibilities for sharing code between the client-side and the server side. While there are several good examples of entire libraries working very well on both ends, most of the projects that are written in Node tend to">
    <meta property="og:url" content="http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/">
    <meta property="og:image" content="../content/images/2017/09/1-9.png">
    <meta property="article:published_time" content="2013-01-15T09:01:00.000Z">
    <meta property="article:modified_time" content="2017-09-26T03:07:30.000Z">
    <meta property="article:publisher" content="https://www.facebook.com/tysoncadenhead">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How Do I Share EJS Templates Between the Client-side and the Server-side?">
    <meta name="twitter:description" content="The release of Node.js in 2009 ushered in discussions about the endless possibilities for sharing code between the client-side and the server side. While there are several good examples of entire libraries working very well on both ends, most of the projects that are written in Node tend to">
    <meta name="twitter:url" content="http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/">
    <meta name="twitter:image" content="http://tysoncadenhead.com/blog/content/images/2017/09/1-9.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Tyson Cadenhead">
    <meta name="twitter:site" content="@tysoncadenhead">
    <meta property="og:image:width" content="1391">
    <meta property="og:image:height" content="800">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Tyson Cadenhead",
        "logo": "http://tysoncadenhead.com/blog/content/images/2017/09/1-2.png"
    },
    "author": {
        "@type": "Person",
        "name": "Tyson Cadenhead",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://tysoncadenhead.com/blog/author/tysoncadenhead/",
        "sameAs": []
    },
    "headline": "How Do I Share EJS Templates Between the Client-side and the Server-side?",
    "url": "http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/",
    "datePublished": "2013-01-15T09:01:00.000Z",
    "dateModified": "2017-09-26T03:07:30.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://tysoncadenhead.com/blog/content/images/2017/09/1-9.png",
        "width": 1391,
        "height": 800
    },
    "description": "The release of Node.js in 2009 ushered in discussions about the endless possibilities for sharing code between the client-side and the server side. While there are several good examples of entire libraries working very well on both ends, most of the projects that are written in Node tend to",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://tysoncadenhead.com/blog/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "f70092546f32"
});
</script>
    <meta name="generator" content="Ghost 1.8">
    <link rel="alternate" type="application/rss+xml" title="Tyson Cadenhead" href="http://tysoncadenhead.com/blog/rss/">

</head>
<body class="post-template">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead"></a>
            <ul class="nav">
    <li class="nav-blog" role="presentation"><a href="../">Blog</a></li>
    <li class="nav-about-me" role="presentation"><a href="../about/">About Me</a></li>
</ul>
    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-fb" href="https://www.facebook.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
                <a class="social-link social-link-tw" href="https://twitter.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
        </div>
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <figure class="post-full-image" style="background-image: url(../content/images/2017/09/1-9.png)">
    </figure>
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2013-01-15">15 January 2013</time>
                </section>
                <h1 class="post-full-title">How Do I Share EJS Templates Between the Client-side and the Server-side?</h1>
            </header>

            <section class="post-full-content">
                <div class="kg-card-markdown"><p>The release of Node.js in 2009 ushered in discussions about the endless possibilities for sharing code between the client-side and the server side. While there are several good examples of entire libraries working very well on both ends, most of the projects that are written in Node tend to shy away from sharing the meat of the application with the browser. I think that the real issue is developers being stuck in our ways. We are trying to write traditional web apps in a language that can actually go beyond what traditional scripting languages were even capable of.</p>
<!-- more -->
<p>The way I am going to propose we build a Node web application isn't a typical MVC setup. However, if we are trying to be purposeful about sharing components, I feel like it really works.</p>
<p>For the sake of this discussion, I'll be using <a href="http://expressjs.com/">Express.js</a> and <a href="http://underscorejs.org/">Underscore</a>. I will also assume that you are familiar with Node and have it running locally on your machine.</p>
<p>This is what our folder structure will look like:</p>
<pre><code>/app
   /config
   /controllers
   /shema
/public
   /css
   /images
   /js
      /models
      /collections
      /controllers
      app.js
   /templates
server.js
</code></pre>
<p>We will need to start by creating a project.</p>
<pre><code>mkdir myProject
cd myProject
npm init
npm install express
npm install underscore
npm install express-ejs-layouts
</code></pre>
<p>Now that we've create our project and installed our dependencies, we can create our server.js file.</p>
<pre><code class="language-javascript">var express = require( 'express' ),
    expressEjsLayouts = require('express-ejs-layouts'),
    app = express();

// Express EJS views
app.set('views', './public/templates“');
app.set('view engine', 'ejs');
app.set('layout', 'layout');
app.use(expressEjsLayouts);

app.listen(8080);
app.use(express['static']('./public'));
</code></pre>
<p>Note that we're pointing our views to the public templates directory. We are also making the public directory serve up static files. That way, it can be entirely used by the client side.</p>
<p>Next, we'll need to create our templates. We'll throw them into the /public/templates/people directory. We will add an index.ejs file that lists all of the people.</p>
<pre><code class="language-html4strict">&lt;ul id=“people“&gt;
   &lt;% people.forEach(person) { %&gt;
      &lt;%- include show.ejs %&gt;
   &lt;% }) %&gt;
&lt;/ul&gt;
&lt;h1&gt;Add a Person&lt;/h1&gt;
&lt;form id=“add“&gt;
   &lt;input id=“name“ name=“name“ placeholder=“Name“ /&gt;
   &lt;input type=“submit“ value=“Add“ /&gt;
&lt;/form&gt;
</code></pre>
<p>The include tag is unique to the server-side implementation of EJS, so we won't be able to use /people/index.ejs on the client-side.</p>
<p>Now, we will include a show.ejs in the same directory. It will render the individual people in the list.</p>
<pre><code class="language-html4strict">&lt;li&gt;&lt;%= person %&gt;&lt;/li&gt;
</code></pre>
<p>You may have also noticed that we have a layout listed in our server.js file. We will need to create a  /public/templates/layout.ejs file to provide our layout. The client-side won't need to use layout.ejs, but it doesn't hurt anything for it to be public.</p>
<pre><code class="language-html4strict">&lt;!DOCTYPE html&gt;
&lt;html&gt;
   &lt;head&gt;
   &lt;/head&gt;
   &lt;body&gt;
      &lt;%- body %&gt;
      &lt;script type=“text/javascript“ data-main=“/js/app.js“ src=“http://requirejs.org/docs/release/2.1.2/minified/require.js“&gt;&lt;/script&gt;
   &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>If we were going to flesh out the entire folder structure I presented in the beginning, the next part would be split out between a model and a controller. However, we can just add it to the bottom of server.js file for the sake of simplicity. It will take any request to /people and render the index.ejs template with the fake data we pass into it.</p>
<pre><code class="language-javascript">app.get('/people', function (req, res) {
   var people = [{
      name: 'Pooh'
   }, {
      name: 'Tigger'
   }, {
      name: 'Rabbit'
   }, {
      name: 'Piglet'
   }];
   res.render('people/index', { people: people });
});
</code></pre>
<p>The last piece is our client-side JavaScript. A real application should split this out into more pieces as well, but we will just put everything in our js/app.js file for this demonstration.</p>
<pre><code class="language-javascript">requirejs.config({
   paths: {
      'jquery': 'http://code.jquery.com/jquery-1.8.3.min.js',
      'underscore': 'http://underscorejs.org/underscore-min.js',
      'text': 'https://raw.github.com/requirejs/text/latest/text.js'
   }
});

define([
   'underscore',
   'jquery',
   'text!/templates/people/show.ejs'
], function (_, $, Template) {

   $('#add').bind('submit', function () {

      var template = _.template(Template),
          data = { person: {
             name: $('#name').val()
          }};

      $('#list').append(
         template(data);
      );

      return false;

   });
});
</code></pre>
<p>As you can see, the above example reuses our template partial to update the display. This is obviously a very simple and contrived example of how templates can be shared, but the concept can be used much more broadly. There is probably no legitimate reason for any sensitive data to be openly viewable in a template, so making all the templates public should never be a problem.</p>
<p>In the next few weeks, I'm going to expand this discussion to address how this same concept can be applied to create a fully functional Backbone app that also shares models and collections between the client-side and the server-side. The main thing to remember when we are taking this approach is to not include anything that is sensitive in the public folder. If people can read your source code, they probably will.</p>
<p>Has anyone else experimented with sharing code between the Node and the browser? What are your thoughts on it?</p>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to Tyson Cadenhead</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <!-- Begin MailChimp Signup Form -->
                <div id="mc_embed_signup">
                <form action="//tysoncadenhead.us9.list-manage.com/subscribe/post?u=97e25799111f2cec4dc714a43&amp;id=501ae643d4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                    <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                    
                    <div class="form-group">
                        <input type="email" value="" name="EMAIL" class="subscribe-email" id="mce-EMAIL" placeholder="youremail@example.com">
                    </div>
                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_97e25799111f2cec4dc714a43_501ae643d4" tabindex="-1" value=""></div>
                        <div class="clear">
                            <button type="submit" name="subscribe" id="mc-embedded-subscribe">
                                <span>Subscribe</span>
                            </button>
                        </div>
                    </form></div>
                

                <!--End mc_embed_signup-->
            </section>

            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></h4>
                            <p>Read <a href="../author/tysoncadenhead/">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="../author/tysoncadenhead/">Read More</a>
                </div>

            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post">
        <a class="post-card-image-link" href="../top-10-backbone-plugins/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/20-1.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../top-10-backbone-plugins/">
            <header class="post-card-header">
                <h2 class="post-card-title">Top 5 Backbone Plugins</h2>
            </header>
            <section class="post-card-excerpt">
                <p>BackboneJS is a great framework for building large scalable JavaScript applications. One of the best things about Backbone is that the community has built countless amazing plugins that extend the Backbone namespace. I've</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

                <article class="post-card post">
        <a class="post-card-image-link" href="../underscore-fire/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/2-5.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../underscore-fire/">
            <header class="post-card-header">
                <h2 class="post-card-title">_.fire(): A Plugin for Underscore</h2>
            </header>
            <section class="post-card-excerpt">
                <p>JavaScript is different from other programming languages because it is asynchronous. That means that there is a possibility that several things can be happening at the same time. In other words, JavaScript doesn't</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>Tyson Cadenhead</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">How Do I Share EJS Templates Between the Client-side and the Server-side?</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=How%20Do%20I%20Share%20EJS%20Templates%20Between%20the%20Client-side%20and%20the%20Server-side%3F&url=http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://tysoncadenhead.com/blog/how-can-i-share-ejs-templates-between-the-client-side-and-the-server-side/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">Tyson Cadenhead</a> &copy; 2017</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    <a href="https://www.facebook.com/tysoncadenhead" target="_blank">Facebook</a>
                    <a href="https://twitter.com/tysoncadenhead" target="_blank">Twitter</a>
                    <a href="https://ghost.org" target="_blank">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
                <img class="subscribe-overlay-logo" src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead">
            <h1 class="subscribe-overlay-title">Subscribe to Tyson Cadenhead</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            
            <!-- Begin MailChimp Signup Form -->
            <div id="mc_embed_signup">
            <form action="//tysoncadenhead.us9.list-manage.com/subscribe/post?u=97e25799111f2cec4dc714a43&amp;id=501ae643d4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                <div id="mc_embed_signup_scroll">
                
            <div class="mc-field-group">
                <label for="mce-EMAIL">Email Address </label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
            </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_97e25799111f2cec4dc714a43_501ae643d4" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </div>
            </form>
            </div>

            <!--End mc_embed_signup-->


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js"></script>


    

    <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19696495-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>

<script type="text/javascript">
    $('.subscribe-button').click((e) => {
        e.preventDefault();
        document.location.href = 'http://eepurl.com/c49YyL';
    });
</script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

</body>
</html>

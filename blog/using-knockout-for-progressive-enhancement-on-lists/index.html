<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Progressive Enhancement With the Knockout Foreach Binding</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/amp/">
    
    <meta property="og:site_name" content="Tyson Cadenhead">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Progressive Enhancement With the Knockout Foreach Binding">
    <meta property="og:description" content="In my previous blog post, I talked about how you can use Knockout to enhance forms that are rendered from the server. This led to my next challenge - creating lists that are rendered from the server and then managed with Knockout on the client-side in instances where JavaScript is">
    <meta property="og:url" content="http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/">
    <meta property="og:image" content="../content/images/2017/09/4-1.png">
    <meta property="article:published_time" content="2014-07-28T08:01:00.000Z">
    <meta property="article:modified_time" content="2017-09-26T01:44:04.000Z">
    <meta property="article:publisher" content="https://www.facebook.com/tysoncadenhead">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Progressive Enhancement With the Knockout Foreach Binding">
    <meta name="twitter:description" content="In my previous blog post, I talked about how you can use Knockout to enhance forms that are rendered from the server. This led to my next challenge - creating lists that are rendered from the server and then managed with Knockout on the client-side in instances where JavaScript is">
    <meta name="twitter:url" content="http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/">
    <meta name="twitter:image" content="http://tysoncadenhead.com/content/images/2017/09/4-1.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Tyson Cadenhead">
    <meta name="twitter:site" content="@tysoncadenhead">
    <meta property="og:image:width" content="1391">
    <meta property="og:image:height" content="800">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Tyson Cadenhead",
        "logo": "http://tysoncadenhead.com/content/images/2017/09/1-2.png"
    },
    "author": {
        "@type": "Person",
        "name": "Tyson Cadenhead",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://tysoncadenhead.com/author/tysoncadenhead/",
        "sameAs": []
    },
    "headline": "Progressive Enhancement With the Knockout Foreach Binding",
    "url": "http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/",
    "datePublished": "2014-07-28T08:01:00.000Z",
    "dateModified": "2017-09-26T01:44:04.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://tysoncadenhead.com/content/images/2017/09/4-1.png",
        "width": 1391,
        "height": 800
    },
    "description": "In my previous blog post, I talked about how you can use Knockout to enhance forms that are rendered from the server. This led to my next challenge - creating lists that are rendered from the server and then managed with Knockout on the client-side in instances where JavaScript is",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://tysoncadenhead.com/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "f70092546f32"
});
</script>
    <meta name="generator" content="Ghost 1.8">
    <link rel="alternate" type="application/rss+xml" title="Tyson Cadenhead" href="http://tysoncadenhead.com/rss/">

</head>
<body class="post-template">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead"></a>
            <ul class="nav">
    <li class="nav-blog" role="presentation"><a href="../">Blog</a></li>
    <li class="nav-about-me" role="presentation"><a href="../about/">About Me</a></li>
</ul>
    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-fb" href="https://www.facebook.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
                <a class="social-link social-link-tw" href="https://twitter.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
        </div>
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <figure class="post-full-image" style="background-image: url(../content/images/2017/09/4-1.png)">
    </figure>
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2014-07-28">28 July 2014</time>
                </section>
                <h1 class="post-full-title">Progressive Enhancement With the Knockout Foreach Binding</h1>
            </header>

            <section class="post-full-content">
                <div class="kg-card-markdown"><p>In my <a href="../blog/using-knockout-for-progressive-enhancement/">previous blog post</a>, I talked about how you can use Knockout to enhance forms that are rendered from the server. This led to my next challenge - creating lists that are rendered from the server and then managed with Knockout on the client-side in instances where JavaScript is enabled.</p>
<!-- more -->
<p><img src="http://elitedaily.com/wp-content/uploads/2013/04/pote2.jpg" alt=""></p>
<h3 id="onepotentialapproach">One Potential Approach</h3>
<p>Okay, let's say for example that you have a list of animals that are being rendered from the server-side like this:</p>
<pre><code class="language-html">&lt;ul&gt;
    &lt;li&gt;Dog&lt;/li&gt;
    &lt;li&gt;Cat&lt;/li&gt;
    &lt;li&gt;Goldfish&lt;/li&gt;
    &lt;li&gt;Chicken&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p>The problem with binding that list with a Knockout <code>foreach</code> is that there are multiple items inside the list that the server is rendering and a foreach would typically only require a single list item to represent everything in an observable array like this:</p>
<pre><code class="language-html">&lt;ul data-bind=“foreach: animals“&gt;
    &lt;li data-bind=“text: name“&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p>If our goal is to to create a single list that can even be used when JavaScript is disabled, but enhanced with Knockout, what we need to do involves creating a custom binding that loops over the existing elements inside the <code>&lt;ul&gt;</code> and applies the data in it to an observable array. Once our data is in the array, we can replace the <code>&lt;li&gt;</code> elements that came back from the server with our own Knockout template, which can re-render the list items from the client-side.</p>
<pre><code class="language-js">ko.bindingHandlers.initialForEach = {
    init: function (element, valueAccessor, allBindings) {
        var $el = $(element);
        $el.children().each(function () {
            if (allBindings().foreach) {
                allBindings().foreach.push(JSON.parse($(this).attr('data-options')));
            }
        });
        $el.html(valueAccessor().template);
    }
};
</code></pre>
<p><img src="http://www.allure.com/beauty-trends/blogs/daily-beauty-reporter/2013/05/23/sunscreen-being-applied-to-child.jpg" alt=""></p>
<h3 id="applyingmyapproach">Applying My Approach</h3>
<p>Applying our new binding would look something like this:</p>
<pre><code class="language-html">&lt;ul data-bind='initialForEach: {
    template: forEachTemplate
}, foreach: animals'&gt;
    &lt;li data-options='{ “id“: 1, “type“: “Mammal“, “name“: “Dog“ }'&gt;Dog&lt;/li&gt;
    &lt;li data-options='{ “id“: 2, “type“: “Mammal“, “name“: “Cat“ }'&gt;Cat&lt;/li&gt;
    &lt;li data-options='{ “id“: 3, “type“: “Fish“, “name“: “Goldfish“ }'&gt;Goldfish&lt;/li&gt;
    &lt;li data-options='{ “id“: 5, “type“: “Bird“, “name“: “Chicken“ }'&gt;Chicken&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p>You might notice that I'm passing all of the data for each list item into a <code>data-options</code> attribute. I've been thinking long and hard about how to accomplish this by looking inside the list elements and grabbing the content inside of each element, but there may be any number of properties that you'll want to pass into your observable array and to be able to keep this binding reusable and generic, passing in a string of JSON seems the most efficient.</p>
<p>I'll go ahead and put a viewModel behind the template. The animals observableArray will hold all of the data we need. I added another animal to demonstrate how the client-side and server-side data can be merged together. We also have a string template that will replace the server-rendered list items with the ones coming from the client. Just for fun, I additionally added a click event that tells us which animal was clicked.</p>
<pre><code class="language-js">var viewModel = {
    animals: ko.observableArray([{
        id: 4,
        type: 'Mammal',
        name: 'Mouse'
    }]),
    clickAnimal: function (animal) {
        alert('Name: ' + animal.name + ', Type: ' + animal.type);
    },
    forEachTemplate: '&lt;li data-bind=“text: name, click: $parent.clickAnimal“&gt;&lt;/li&gt;'
};
</code></pre>
<p>If you want to see this in action, I've created a <a href="http://jsfiddle.net/QPrPW/">JSFiddle</a> that combines all of the steps together.</p>
<p><img src="http://petapixel.com/assets/uploads/2009/07/7motivated-critique.jpg" alt=""></p>
<h3 id="criticizingmyapproach">Criticizing My Approach</h3>
<p>This approach is far from perfect. For one thing, you are rendering everything in the list twice. It may not be the end of the world for a short list, but if you have a ton of items complete with images or other media, you may take a performance hit. Another issue is the awkwardness of needing to write a template for the <code>&lt;li&gt;</code> tags for the server and the client. There could certainly be more room for mistake when you have to write basically the same functionality twice.</p>
<p>If you have a better approach, I'd be interested to hear it. This is the best I could come up with, but its far from ideal.</p>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to Tyson Cadenhead</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


            </section>

            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></h4>
                            <p>Read <a href="../author/tysoncadenhead/">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="../author/tysoncadenhead/">Read More</a>
                </div>

            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post">
        <a class="post-card-image-link" href="../the-state-of-javascript-a-shift-from-imperative-to-declarative/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/3.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../the-state-of-javascript-a-shift-from-imperative-to-declarative/">
            <header class="post-card-header">
                <h2 class="post-card-title">The State Of JavaScript - A Shift From Imperative To Declarative</h2>
            </header>
            <section class="post-card-excerpt">
                <p>JavaScript has seen a ton of development even in the past 5 years. The changes haven't been so much in the language itself, but in how the language is being used. This has</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

                <article class="post-card post">
        <a class="post-card-image-link" href="../using-knockout-for-progressive-enhancement/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/6-1.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../using-knockout-for-progressive-enhancement/">
            <header class="post-card-header">
                <h2 class="post-card-title">Using Knockout For Progressive Enhancement</h2>
            </header>
            <section class="post-card-excerpt">
                <p>One of the great things about all of the best MV* frameworks is that they allow you to hardly render any templates on the server-side. That means that you only need to hit</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>Tyson Cadenhead</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Progressive Enhancement With the Knockout Foreach Binding</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Progressive%20Enhancement%20With%20the%20Knockout%20Foreach%20Binding&url=http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://tysoncadenhead.com/using-knockout-for-progressive-enhancement-on-lists/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">Tyson Cadenhead</a> &copy; 2017</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    <a href="https://www.facebook.com/tysoncadenhead" target="_blank">Facebook</a>
                    <a href="https://twitter.com/tysoncadenhead" target="_blank">Twitter</a>
                    <a href="https://ghost.org" target="_blank">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
                <img class="subscribe-overlay-logo" src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead">
            <h1 class="subscribe-overlay-title">Subscribe to Tyson Cadenhead</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js"></script>


    

    <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19696495-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

</body>
</html>

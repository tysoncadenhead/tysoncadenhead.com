<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Adding Dependencies</title>
    <meta name="google-site-verification" content="AeV4w7EOhEv3lU1OT8KOM7jRS0C6jDAsZyMaG38t1g4">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://tysoncadenhead.com/blog/adding-dependencies/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="http://tysoncadenhead.com/blog/adding-dependencies/amp/">
    
    <meta property="og:site_name" content="Tyson Cadenhead">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Adding Dependencies">
    <meta property="og:description" content="As I promised at the beginning of this series, we are going to be using RequireJS to manage our client-side modules. If you haven&#x27;t used RequireJS or a similar AMD loader before, let me just say that you are really missing out. RequireJS lets you write your code in small">
    <meta property="og:url" content="http://tysoncadenhead.com/blog/adding-dependencies/">
    <meta property="og:image" content="../content/images/2017/09/1-4.png">
    <meta property="article:published_time" content="2014-05-30T08:01:00.000Z">
    <meta property="article:modified_time" content="2017-09-26T01:53:57.000Z">
    <meta property="article:publisher" content="https://www.facebook.com/tysoncadenhead">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Adding Dependencies">
    <meta name="twitter:description" content="As I promised at the beginning of this series, we are going to be using RequireJS to manage our client-side modules. If you haven&#x27;t used RequireJS or a similar AMD loader before, let me just say that you are really missing out. RequireJS lets you write your code in small">
    <meta name="twitter:url" content="http://tysoncadenhead.com/blog/adding-dependencies/">
    <meta name="twitter:image" content="http://tysoncadenhead.com/blog/content/images/2017/09/1-4.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Tyson Cadenhead">
    <meta name="twitter:site" content="@tysoncadenhead">
    <meta property="og:image:width" content="1391">
    <meta property="og:image:height" content="800">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Tyson Cadenhead",
        "logo": "http://tysoncadenhead.com/blog/content/images/2017/09/1-2.png"
    },
    "author": {
        "@type": "Person",
        "name": "Tyson Cadenhead",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://tysoncadenhead.com/blog/author/tysoncadenhead/",
        "sameAs": []
    },
    "headline": "Adding Dependencies",
    "url": "http://tysoncadenhead.com/blog/adding-dependencies/",
    "datePublished": "2014-05-30T08:01:00.000Z",
    "dateModified": "2017-09-26T01:53:57.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://tysoncadenhead.com/blog/content/images/2017/09/1-4.png",
        "width": 1391,
        "height": 800
    },
    "description": "As I promised at the beginning of this series, we are going to be using RequireJS to manage our client-side modules. If you haven&#x27;t used RequireJS or a similar AMD loader before, let me just say that you are really missing out. RequireJS lets you write your code in small",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://tysoncadenhead.com/blog/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "f70092546f32"
});
</script>
    <meta name="generator" content="Ghost 1.8">
    <link rel="alternate" type="application/rss+xml" title="Tyson Cadenhead" href="http://tysoncadenhead.com/blog/rss/">

</head>
<body class="post-template">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead"></a>
            <ul class="nav">
    <li class="nav-blog" role="presentation"><a href="../">Blog</a></li>
    <li class="nav-about-me" role="presentation"><a href="../about/">About Me</a></li>
</ul>
    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-fb" href="https://www.facebook.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
                <a class="social-link social-link-tw" href="https://twitter.com/tysoncadenhead" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
        </div>
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <figure class="post-full-image" style="background-image: url(../content/images/2017/09/1-4.png)">
    </figure>
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2014-05-30">30 May 2014</time>
                </section>
                <h1 class="post-full-title">Adding Dependencies</h1>
            </header>

            <section class="post-full-content">
                <div class="kg-card-markdown"><p>As I promised at the beginning of this series, we are going to be using <a href="http://requirejs.org/">RequireJS</a> to manage our client-side modules. If you haven't used RequireJS or a similar AMD loader before, let me just say that you are really missing out. RequireJS lets you write your code in small modules that only expose the parts of the API that you want to show and as an added bonus, it uses JavaScript to load your JavaScript modules.</p>
<!-- more -->
<img src="“http:/bower.io/img/bower-logo.png“/" width="“250px“">
<h4 id="wecanusebowerright">We Can Use Bower, Right?</h4>
<p>Before we get started, I wanted to give a quick rant about why using bower in a Sails project hasn't worked very well for me. <a href="http://bower.io">Bower</a> is a package manager for client-side JavaScript much like <a href="http://www.npmjs.com/">NPM</a> is for server-side JavaScript. Typically, I would use bower to manage my dependencies for any project. The issue is that Sails doesn't run your assets right out of the folder you create them in. Instead, it packages them up with Grunt and runs them out of <code>.tmp/public</code>. That approach is really helpful if you have a compilation step such as converting SASS or LESS stylesheets to CSS or minifying your JavaScript. The issue is that it if you have a ton of files in your assets directory, as is often the case when you have installed bower packages, you will inevitably either get errors complaining about the number of files being processed or it will be painfully slow. Either way, I've come to the painful conclusion that using Bower with Sails is more trouble than it is worth.</p>
<p>My compromise is typically to load my vendor files from a CDN whenever there is one instead of junking up my project with code that I didn't write.</p>
<p><img src="http://ianreah.com/img/requirejs-logo.png" alt="RequireJS"></p>
<h4 id="requirejs">RequireJS</h4>
<p>There is actually some debate about whether or not RequireJS has value in an Angular project. Angular has a dependency injection concept that makes running the code itself pretty modular. However, it doesn't load specific files for you out of the box. There are a few ways to leverage the Angular library to load your files for you. To me, though, it seems simpler to follow a set standard like what RequireJS provides by closely following the AMD spec. That way, developers in the future will have a clearer idea of where the code is coming from and how it is being loaded.</p>
<p>So, let's get RequireJS working.</p>
<p>Let's open the layout.ejs file and add a line to instantiate our Angular application. We will replace the body tag with this:</p>
<pre><code class="language-html">&lt;body ng-app=“todoIt“&gt;
</code></pre>
<p>The name of the app can be whatever you want to call your application, but just be aware that you will be referencing it later in your javaScript.</p>
<p>Next, we need to go to the bottom of the layout.ejs file and replace all of the JavaScript files with this:</p>
<pre><code class="language-html">&lt;script src=“//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.11/require.min.js“ data-main=“/js/main“&gt;&lt;/script&gt;
</code></pre>
<p>That will load the require.min.js file from a CDN and then immediately require your <code>/js/main.js</code> file. Don't have a main.js file yet? No problem. Let's go ahead and build that.</p>
<pre><code class="language-js">window.name = 'NG_DEFER_BOOTSTRAP!';

require.config({
  'baseUrl': '/js',
  'paths': {
    'angular': '//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular',
    'jquery': '//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min',
    'bootstrap': '//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min'
  },
  'shim': {
    'angular': {
      'exports': 'angular'
    },
    'bootstrap': {
      'deps': ['jquery']
    },
    'socket.io': {
      'exports': 'io'
    },
    'sails.io': {
      'deps': ['socket.io'],
      'exports': 'io'
    }
  }
});

require([
  'angular',
  'app',
  'bootstrap'
], function (angular, app) {

  angular.element(document.getElementsByTagName('html')[0]);

  angular.element().ready(function() {
    angular.resumeBootstrap([app.name]);
  });

});
</code></pre>
<p>Notice at the top where we set the <code>window.name</code> to “NG_DEFER_BOOTSTRAP!“. That will keep angular from initializing until we tell it to. Near the bottom after everything is loaded, we call angular.resumeBootstrap(). That is where angular picks back up and finishes initializing.</p>
<p>The <a href="http://socket.io">socket.io</a> and <a href="http://sails.io">sails.io</a> files that come with Sails are not wrapped as AMD modules, so we need to shim them both and export the io variable.</p>
<p>Otherwise, the main.js is pretty standard for a requireJS config file.</p>
<p>We will also need to update the app.js file to this:</p>
<pre><code class="language-js">define([
  'angular',
  'sails.io'
], function (angular, io) {

  var socket = io.connect(), app;

  socket.on('connect', function socketConnected() {
    console.log('Socket is now connected');
  });

  app = angular.module('todoIt', []);

  return app;

});
</code></pre>
<p>We are leaving the <a href="http://socket.io">socket.io</a> connection. We'll be working with that later on. For now, we mostly just want to return our app as a new angular module. Notice that the name “todoIt“ is the same as the <code>ng-app</code> that we added to our layout.ejs file.</p>
<p>Now the main.js file will take the app that is returned from app.js and create an angular application.</p>
<p>When you look at your console at this point, you should get a message that says:</p>
<pre><code class="language-bash">Socket is now connected 
</code></pre>
<p>If you see that and don't get any errors, you have successfully added an angular application on top of Sails. Stay tuned next time when we make the application actually do something.</p>
<p>If you want to see the code in action, check out the example repository <a href="https://github.com/tysoncadenhead/sails-angular-example-app/tree/ffc98437c91b4bf154c9619fd50b103c9549a465">here</a>.</p>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to Tyson Cadenhead</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <!-- Begin MailChimp Signup Form -->
                <div id="mc_embed_signup">
                <form action="//tysoncadenhead.us9.list-manage.com/subscribe/post?u=97e25799111f2cec4dc714a43&amp;id=501ae643d4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                    <div id="mce-responses" class="clear">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                    
                    <div class="form-group">
                        <input type="email" value="" name="EMAIL" class="subscribe-email" id="mce-EMAIL" placeholder="youremail@example.com">
                    </div>
                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_97e25799111f2cec4dc714a43_501ae643d4" tabindex="-1" value=""></div>
                        <div class="clear">
                            <button type="submit" name="subscribe" id="mc-embedded-subscribe">
                                <span>Subscribe</span>
                            </button>
                        </div>
                    </form></div>
                

                <!--End mc_embed_signup-->
            </section>

            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></h4>
                            <p>Read <a href="../author/tysoncadenhead/">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="../author/tysoncadenhead/">Read More</a>
                </div>

            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">

                <article class="post-card post">
        <a class="post-card-image-link" href="../angular-controllers-with-sails-app/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/10.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../angular-controllers-with-sails-app/">
            <header class="post-card-header">
                <h2 class="post-card-title">Angular Controllers</h2>
            </header>
            <section class="post-card-excerpt">
                <p>In the past few posts, I've been laying the groundwork for building an Angular application on top of Sails. Now that everything is in place, we can jump right in to adding Angular</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

                <article class="post-card post">
        <a class="post-card-image-link" href="../server-side-views/">
            <div class="post-card-image" style="background-image: url(../content/images/2017/09/2-1.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../server-side-views/">
            <header class="post-card-header">
                <h2 class="post-card-title">Sails Server-Side Views</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Today, we are going to look at how Sails.js handles server-side templating. Sails lets you use whatever type of templating you want want, but out of the box, it uses EJS, which</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="//www.gravatar.com/avatar/283773207d6e2c2b9f2a86f7088a7328?s=250&d=mm&r=x" alt="Tyson Cadenhead">
            <span class="post-card-author"><a href="../author/tysoncadenhead/">Tyson Cadenhead</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>Tyson Cadenhead</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Adding Dependencies</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Adding%20Dependencies&url=http://tysoncadenhead.com/blog/adding-dependencies/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://tysoncadenhead.com/blog/adding-dependencies/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">Tyson Cadenhead</a> &copy; 2017</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    <a href="https://www.facebook.com/tysoncadenhead" target="_blank">Facebook</a>
                    <a href="https://twitter.com/tysoncadenhead" target="_blank">Twitter</a>
                    <a href="https://ghost.org" target="_blank">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
                <img class="subscribe-overlay-logo" src="../content/images/2017/09/1-2.png" alt="Tyson Cadenhead">
            <h1 class="subscribe-overlay-title">Subscribe to Tyson Cadenhead</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            
            <!-- Begin MailChimp Signup Form -->
            <div id="mc_embed_signup">
            <form action="//tysoncadenhead.us9.list-manage.com/subscribe/post?u=97e25799111f2cec4dc714a43&amp;id=501ae643d4" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
                <div id="mc_embed_signup_scroll">
                
            <div class="mc-field-group">
                <label for="mce-EMAIL">Email Address </label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
            </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_97e25799111f2cec4dc714a43_501ae643d4" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </div>
            </form>
            </div>

            <!--End mc_embed_signup-->


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js"></script>


    

    <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19696495-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>

<script type="text/javascript">
    $('.subscribe-button').click((e) => {
        e.preventDefault();
        document.location.href = 'http://eepurl.com/c49YyL';
    });
</script>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

</body>
</html>
